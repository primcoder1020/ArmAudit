"use client"

import React from "react"
import { Box, Typography, Card, CardContent, Grid, Chip, LinearProgress } from "@mui/material"
import { Security, Warning, BugReport, TrendingUp } from "@mui/icons-material"

export default function VulnerabilityIntelligencePage() {
  const vulnStats = [
    { title: "Total Vulnerabilities", count: 1247, severity: "Mixed", color: "#3b82f6" },
    { title: "Critical CVEs", count: 23, severity: "Critical", color: "#ef4444" },
    { title: "Zero-Day Threats", count: 3, severity: "Critical", color: "#dc2626" },
    { title: "Patched This Month", count: 156, severity: "Resolved", color: "#22c55e" },
  ]

  const recentCVEs = [
    {
      id: "CVE-2024-0001",
      title: "Remote Code Execution in Apache HTTP Server",
      score: 9.8,
      severity: "Critical",
      published: "2 days ago",
      affected: "Apache HTTP Server 2.4.x"
    },
    {
      id: "CVE-2024-0002", 
      title: "SQL Injection in MySQL Connector",
      score: 7.5,
      severity: "High",
      published: "5 days ago",
      affected: "MySQL Connector/J 8.x"
    },
    {
      id: "CVE-2024-0003",
      title: "Buffer Overflow in OpenSSL",
      score: 8.2,
      severity: "High", 
      published: "1 week ago",
      affected: "OpenSSL 3.0.x"
    },
    {
      id: "CVE-2024-0004",
      title: "Cross-Site Scripting in React",
      score: 6.1,
      severity: "Medium",
      published: "2 weeks ago",
      affected: "React 18.x"
    }
  ]

  const exploitTrends = [
    { category: "Web Applications", count: 45, trend: "+12%" },
    { category: "Network Services", count: 32, trend: "+8%" },
    { category: "Operating Systems", count: 28, trend: "-3%" },
    { category: "Mobile Apps", count: 19, trend: "+15%" },
  ]

  return (
    <Box>
      {/* Header */}
      <Box sx={{ mb: 4 }}>
        <Typography variant="h4" sx={{ fontWeight: "bold", color: "#111827", mb: 1 }}>
          Vulnerability Intelligence
        </Typography>
        <Typography variant="body1" sx={{ color: "#6b7280" }}>
          Track and analyze security vulnerabilities, CVEs, and exploit intelligence
        </Typography>
      </Box>

      {/* Stats Cards */}
      <Grid container spacing={3} sx={{ mb: 4 }}>
        {vulnStats.map((item, index) => (
          <Grid item xs={12} sm={6} md={3} key={index}>
            <Card sx={{ height: "100%" }}>
              <CardContent>
                <Box sx={{ display: "flex", alignItems: "center", mb: 2 }}>
                  {index === 0 && <Security sx={{ color: item.color, mr: 1 }} />}
                  {index === 1 && <Warning sx={{ color: item.color, mr: 1 }} />}
                  {index === 2 && <BugReport sx={{ color: item.color, mr: 1 }} />}
                  {index === 3 && <TrendingUp sx={{ color: item.color, mr: 1 }} />}
                  <Typography variant="h6" sx={{ fontWeight: 600 }}>
                    {item.count.toLocaleString()}
                  </Typography>
                </Box>
                <Typography variant="body2" sx={{ color: "#6b7280", mb: 1 }}>
                  {item.title}
                </Typography>
                <Chip 
                  label={item.severity} 
                  size="small" 
                  sx={{ 
                    bgcolor: item.color, 
                    color: "white",
                    fontSize: "11px"
                  }} 
                />
              </CardContent>
            </Card>
          </Grid>
        ))}
      </Grid>

      <Grid container spacing={3}>
        {/* Recent CVEs */}
        <Grid item xs={12} md={8}>
          <Card sx={{ height: "100%" }}>
            <CardContent>
              <Typography variant="h6" sx={{ fontWeight: 600, mb: 3 }}>
                Recent CVE Alerts
              </Typography>
              {recentCVEs.map((cve, index) => (
                <Box key={index} sx={{ 
                  p: 2,
                  border: "1px solid #e5e7eb",
                  borderRadius: 1,
                  mb: 2,
                  "&:last-child": { mb: 0 }
                }}>
                  <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", mb: 2 }}>
                    <Box sx={{ flex: 1 }}>
                      <Typography variant="body1" sx={{ fontWeight: 600 }}>
                        {cve.id}
                      </Typography>
                      <Typography variant="body2" sx={{ color: "#6b7280", mb: 1 }}>
                        {cve.title}
                      </Typography>
                      <Typography variant="caption" sx={{ color: "#9ca3af" }}>
                        Affects: {cve.affected} â€¢ Published {cve.published}
                      </Typography>
                    </Box>
                    <Box sx={{ display: "flex", flexDirection: "column", alignItems: "flex-end", gap: 1 }}>
                      <Chip 
                        label={`CVSS ${cve.score}`}
                        size="small"
                        sx={{
                          bgcolor: "#374151",
                          color: "white",
                          fontSize: "10px"
                        }}
                      />
                      <Chip 
                        label={cve.severity}
                        size="small"
                        sx={{
                          bgcolor: cve.severity === "Critical" ? "#ef4444" : 
                                   cve.severity === "High" ? "#f59e0b" : "#22c55e",
                          color: "white",
                          fontSize: "10px"
                        }}
                      />
                    </Box>
                  </Box>
                  <LinearProgress 
                    variant="determinate" 
                    value={(cve.score / 10) * 100} 
                    sx={{ 
                      height: 4, 
                      borderRadius: 2,
                      bgcolor: "#e5e7eb",
                      "& .MuiLinearProgress-bar": {
                        bgcolor: cve.severity === "Critical" ? "#ef4444" : 
                                 cve.severity === "High" ? "#f59e0b" : "#22c55e"
                      }
                    }} 
                  />
                </Box>
              ))}
            </CardContent>
          </Card>
        </Grid>

        {/* Exploit Trends */}
        <Grid item xs={12} md={4}>
          <Card sx={{ height: "100%" }}>
            <CardContent>
              <Typography variant="h6" sx={{ fontWeight: 600, mb: 3 }}>
                Exploit Trends
              </Typography>
              {exploitTrends.map((trend, index) => (
                <Box key={index} sx={{ 
                  display: "flex", 
                  justifyContent: "space-between", 
                  alignItems: "center",
                  py: 2,
                  borderBottom: index < exploitTrends.length - 1 ? "1px solid #e5e7eb" : "none"
                }}>
                  <Box>
                    <Typography variant="body2" sx={{ fontWeight: 500 }}>
                      {trend.category}
                    </Typography>
                    <Typography variant="caption" sx={{ color: "#6b7280" }}>
                      {trend.count} active exploits
                    </Typography>
                  </Box>
                  <Chip 
                    label={trend.trend}
                    size="small"
                    sx={{
                      bgcolor: trend.trend.startsWith('+') ? "#dcfce7" : "#fef2f2",
                      color: trend.trend.startsWith('+') ? "#16a34a" : "#dc2626",
                      fontSize: "10px"
                    }}
                  />
                </Box>
              ))}
            </CardContent>
          </Card>
        </Grid>
      </Grid>
    </Box>
  )
}
